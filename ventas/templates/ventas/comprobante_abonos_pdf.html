{% load humanize %}
<!DOCTYPE html>
<html>
<head>
Â  Â  <title>Comprobante de Abonos - Venta #{{ venta.pk }}</title>
Â  Â  <style>
Â  Â  Â  Â  body { font-family: sans-serif; font-size: 10pt; }
Â  Â  Â  Â  header { text-align: center; border-bottom: 2px solid #004c99; padding-bottom: 10px; margin-bottom: 20px;}
Â  Â  Â  Â  h1 { color: #004c99; font-size: 18pt; margin: 0; }
Â  Â  Â  Â  h3 { color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-top: 25px;}
Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
Â  Â  Â  Â  th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
Â  Â  Â  Â  tfoot td { background-color: #f2f2f2; font-weight: bold; }
Â  Â  Â  Â  .total-pendiente { color: red; }
Â  Â  </style>
</head>
<body>

Â  Â  <header>
Â  Â  Â  Â  <h1>Movums The Travel Store</h1>
Â  Â  Â  Â  <h2>Comprobante de Abonos</h2>
Â  Â  </header>

Â  Â  <section>
Â  Â  Â  Â  <p><strong>NÃºmero de Venta:</strong> #{{ venta.pk }}</p>
        <p><strong>Cliente:</strong> {{ venta.cliente.nombre_completo_display }}</p> 
Â  Â  Â  Â  <p><strong>Fecha de Viaje:</strong> {{ venta.fecha_inicio_viaje|date:"d/m/Y" }}</p>
Â  Â  Â  Â  <p><strong>Vendedor:</strong> {{ venta.vendedor.username }}</p>
Â  Â  </section>

Â  Â  <section>
Â  Â  Â  Â  <h3>Resumen Financiero</h3>
Â  Â  Â  Â  <p><strong>Costo Total del Viaje:</strong> ${{ venta.costo_venta_final|floatformat:2|intcomma }}</p>
Â  Â  Â  Â  <p><strong>Total Abonado hasta la fecha:</strong> ${{ venta.total_pagado|floatformat:2|intcomma }}</p>
Â  Â  Â  Â  <p><strong>Saldo Pendiente:</strong> <span class="total-pendiente">${{ venta.saldo_restante|floatformat:2|intcomma }}</span></p>
Â  Â  </section>

Â  Â  <section>
Â  Â  Â  Â  <h3>Detalle de Pagos Realizados</h3>
Â  Â  Â  Â  <table>
Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>ID Abono</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Fecha de Pago</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Monto Abonado</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>MÃ©todo de Pago</th>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  {% for abono in venta.abonos.all %}
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ abono.pk }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ abono.fecha_pago|date:"d/m/Y H:i" }}</td>
                    {# ðŸš¨ AJUSTE 2: Se usa 'abono.monto' en lugar de 'abono.monto_abonado' (asumiendo el nombre del campo del modelo AbonoPago) #}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>${{ abono.monto|floatformat:2|intcomma }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td>{{ abono.metodo_pago }}</td>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  {% endfor %}
Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  </table>
Â  Â  </section>

Â  Â  <footer style="position: fixed; bottom: 0; width: 100%;">
Â  Â  Â  Â  <p>Documento generado por el sistema Movums el {{ now|date:"d/m/Y H:i" }}</p>
Â  Â  </footer>

</body>
</html>