{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{{ cotizacion.titulo|default:"Cotización" }}</title>
    <style>
/* ============================================
   ESTILOS PARA PDFs DE COTIZACIONES
   DISEÑO MINIMALISTA MODERNO Y LLAMATIVO
   Generados con WeasyPrint
   ============================================ */

@page {
    size: letter;
    margin-top: 4.7cm;     /* Margen superior: 0.2cm mínimo para membrete + 4.5cm para 6 saltos de línea */
    margin-bottom: 2.5cm;  /* Margen inferior para el footer */
    margin-left: 0.5cm;    /* Margen lateral izquierdo mínimo */
    margin-right: 0.5cm;   /* Margen lateral derecho mínimo */
    {% if membrete_base64 %}
    background-image: url("{{ membrete_base64 }}");
    background-size: cover;
    background-position: center -0.2cm; /* Offset negativo para mostrar la parte superior del membrete */
    background-repeat: no-repeat;
    {% endif %}
}

/* Variables de color Movums - Paleta del Brandboard */
:root {
    /* Colores principales del brandboard */
    --movums-navy: #1A2346;            /* Deep Navy Blue */
    --movums-violet: #5A429C;          /* Violet/Dark Purple */
    --movums-royal: #3B72F4;           /* Royal Blue */
    --movums-medium: #2C96EB;          /* Medium Blue */
    --movums-light: #4FC3F7;           /* Light Blue/Cyan */
    --movums-pale: #E3F2FD;            /* Very Light Blue */
    --movums-green: #8BC34A;           /* Lime Green/Accent */
    --movums-charcoal: #202124;        /* Dark Charcoal/Black */
    
    /* Colores funcionales */
    --movums-primary: var(--movums-navy);
    --movums-secondary: var(--movums-royal);
    --movums-blue-corp: var(--movums-navy);
    --movums-blue: var(--movums-navy);
    
    /* Texto y fondos */
    --text-primary: var(--movums-charcoal);
    --text-secondary: #4a5568;
    --text-muted: #718096;
    --border-light: #E5E7EB;
    --border-medium: #CBD5E0;
    --bg-section: #F9FAFB;
    --bg-white: #ffffff;
    --accent-blue: var(--movums-royal);
    --accent-light: var(--movums-pale);
    --success: var(--movums-green);
    
    /* Espaciado */
    --spacing-xs: 6px;
    --spacing-sm: 12px;
    --spacing-md: 20px;
    --spacing-lg: 32px;
    --spacing-xl: 48px;
}

/* Reset y base */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Pangea', 'Arial', 'Helvetica', 'Segoe UI', sans-serif;
    font-size: 9pt;
    color: var(--text-primary);
    line-height: 1.5;
    margin: 0;
    padding: 0;
    {% if membrete_base64 %}
    background-image: url("{{ membrete_base64 }}");
    background-size: cover;
    background-position: center top; /* Posicionar desde arriba para mostrar la parte superior */
    background-repeat: no-repeat;
    background-attachment: fixed;
    {% else %}
    background: transparent;
    {% endif %}
    width: 100%;
    min-height: 100vh;
    box-sizing: border-box;
    position: relative;
    z-index: 0;
}

/* ============================================
   MEMBRETE COMO FONDO DE PÁGINA COMPLETO
   El membrete ahora es background-image del body
   ============================================ */

.header {
    display: none; /* Header oculto, el membrete es fondo */
}

/* Asegurar que el membrete siempre se vea en TODAS las páginas */
@page :first {
    margin-top: 4.7cm;     /* Margen superior: 0.2cm mínimo para membrete + 4.5cm para 6 saltos de línea */
    margin-bottom: 2.5cm;
    margin-left: 0.5cm;
    margin-right: 0.5cm;
    {% if membrete_base64 %}
    background-image: url("{{ membrete_base64 }}");
    background-size: cover;
    background-position: center -0.2cm; /* Offset negativo para mostrar la parte superior del membrete */
    background-repeat: no-repeat;
    {% endif %}
}

@page :left {
    margin-top: 4.7cm;     /* Margen superior: 0.2cm mínimo para membrete + 4.5cm para 6 saltos de línea */
    margin-bottom: 2.5cm;
    margin-left: 0.5cm;
    margin-right: 0.5cm;
    {% if membrete_base64 %}
    background-image: url("{{ membrete_base64 }}");
    background-size: cover;
    background-position: center -0.2cm; /* Offset negativo para mostrar la parte superior del membrete */
    background-repeat: no-repeat;
    {% endif %}
}

@page :right {
    margin-top: 4.7cm;     /* Margen superior: 0.2cm mínimo para membrete + 4.5cm para 6 saltos de línea */
    margin-bottom: 2.5cm;
    margin-left: 0.5cm;
    margin-right: 0.5cm;
    {% if membrete_base64 %}
    background-image: url("{{ membrete_base64 }}");
    background-size: cover;
    background-position: center -0.2cm; /* Offset negativo para mostrar la parte superior del membrete */
    background-repeat: no-repeat;
    {% endif %}
}

/* ============================================
   CONTENEDOR PRINCIPAL
   ============================================ */
.cotizacion-container {
    width: 100%;
    max-width: 100%;
    margin: 0;
    background: transparent;
    padding: 0 1cm 1cm 1cm; /* Sin padding superior, el espacio viene del @page margin-top (4.7cm) */
    box-sizing: border-box;
    position: relative;
    z-index: 1; /* Contenido sobre el membrete */
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

/* Spacer invisible ya no necesario, el espacio viene del @page margin-top */
.spacer-top {
    height: 0; /* Ya no necesario, el espacio viene del @page margin-top */
    width: 100%;
    margin: 0;
    padding: 0;
    display: none; /* Oculto porque el espacio viene del @page margin-top */
}

/* Asegurar que cuando un elemento aparece al inicio de una nueva página, tenga espacio superior */
.card,
.info-section {
    page-break-before: auto;
    page-break-inside: avoid;
    margin-top: 0;
}

/* Agregar espacio superior cuando una card/info-section aparece después de un salto de página */
/* Usamos margin-top en lugar de ::before para mejor compatibilidad con WeasyPrint */
.card:first-of-type,
.info-section:first-of-type {
    margin-top: 0; /* El spacer-top ya proporciona el espacio en la primera página */
}

/* Cuando un elemento aparece al inicio de una nueva página (después de un salto), agregar espacio */
.card + .card,
.info-section + .info-section {
    margin-top: 0; /* El gap del contenedor maneja el espaciado normal */
}

/* ============================================
   TÍTULO PRINCIPAL - LLAMATIVO Y MODERNO
   ============================================ */
.titulo-principal {
    color: white;
    font-size: 18pt;
    font-weight: 700;
    margin: 0 0 8px 0;
    text-align: left;
    letter-spacing: 0.8px;
    line-height: 1.1;
    padding: 12px 20px;
    text-transform: uppercase;
    box-sizing: border-box;
    background: var(--movums-navy);
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(26, 35, 70, 0.1);
    page-break-after: avoid;
    width: 100%; /* Asegurar que ocupe todo el ancho disponible */
}

/* ============================================
   CARDS - DISEÑO MODERNO Y LLAMATIVO
   ============================================ */
.card {
    background: white;
    border: none;
    border-radius: 6px; /* Reducido de 8px */
    padding: 0;
    margin: 0 0 8px 0; /* Reducido aún más para ahorrar papel */
    box-shadow: 0 1px 4px rgba(26, 35, 70, 0.08);
    page-break-inside: avoid;
    page-break-before: auto;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    overflow: hidden;
}

/* Permitir que cards muy largas se dividan, pero mantener header y total juntos */
.card-header {
    page-break-after: avoid;
}

/* Agregar espacio después del card-header y antes de las tablas (2 saltos de línea = 1.5cm) */
.card-header + .data-table,
.card-header + .info-table {
    margin-top: 1.5cm !important; /* 2 saltos de línea más */
}

.total-destacado {
    page-break-before: avoid;
}

.card-header {
    background: var(--movums-navy);
    color: white;
    font-size: 10.5pt;
    font-weight: 600;
    margin: 0;
    padding: 12px 16px; /* Aumentado aún más el padding vertical para que el icono quepa completamente */
    display: flex;
    align-items: center; /* Centrar verticalmente icono y texto */
    gap: 12px;
    letter-spacing: 0.4px;
    text-transform: uppercase;
    box-sizing: border-box;
    border-bottom: none;
    position: relative;
    flex-direction: row;
    min-height: 46px; /* Altura mínima aumentada para que el icono quepa completamente dentro */
    overflow: visible; /* Asegurar que el icono no se corte */
}

.card-header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
}

/* Asegurar que el icono esté siempre a la izquierda */
.card-header > * {
    order: 0; /* Resetear orden por defecto */
}

.card-header .icon {
    order: -1 !important; /* Forzar que el icono esté PRIMERO (a la izquierda) */
    width: 28px; /* Aumentado ligeramente más */
    height: 28px; /* Aumentado ligeramente más */
    display: inline-flex;
    align-items: center; /* Centrar verticalmente el icono */
    justify-content: center;
    background: transparent;
    border-radius: 0;
    padding: 0;
    flex-shrink: 0;
    margin-right: 0;
    vertical-align: middle; /* Asegurar alineación vertical */
}

.card-header .icon svg {
    width: 26px; /* Aumentado ligeramente más */
    height: 26px; /* Aumentado ligeramente más */
    fill: white !important;
    stroke: white !important;
    color: white !important;
    opacity: 1;
    display: block;
    vertical-align: middle; /* Asegurar alineación vertical */
}

/* ============================================
   TABLA DE INFORMACIÓN - ELEGANTE
   ============================================ */
.info-section {
    margin-bottom: 0;
    width: 100%;
    box-sizing: border-box;
    background: transparent;
    padding: 0;
}

.info-section-layout {
    display: flex;
    gap: 20px;
    align-items: flex-start;
    margin-top: 8px;
    page-break-inside: avoid;
    justify-content: flex-start;
    max-width: 100%;
    width: 100%;
}

.info-section-main {
    flex: 2;
    min-width: 0;
    max-width: 58%;
}

.info-section-sidebar {
    flex: 1;
    min-width: 300px;
    max-width: 340px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-left: -180px; /* Aumentado aún más el desplazamiento hacia la izquierda para alinearlas con la línea negra */
    align-items: stretch;
}

.info-card-client {
    background: white !important;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(26, 35, 70, 0.15);
    padding: 0 !important;
    overflow: hidden;
}

.info-card-client .info-table {
    padding: 12px 16px; /* Reducido aún más */
    margin: 0;
}

/* Tarjetas laterales con colores */
.sidebar-card {
    background: var(--movums-royal);
    border-radius: 6px; /* Reducido de 8px */
    padding: 10px 12px; /* Reducido aún más */
    box-shadow: 0 1px 4px rgba(26, 35, 70, 0.08);
    color: white;
    page-break-inside: avoid;
    page-break-before: auto;
}

.sidebar-card.purple {
    background: var(--movums-violet);
}

.sidebar-card.blue {
    background: var(--movums-medium);
}

.sidebar-card-title {
    font-size: 9.5pt; /* Reducido aún más */
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 10px; /* Reducido de 14px */
    padding-bottom: 8px; /* Reducido de 10px */
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.sidebar-card-content {
    font-size: 8.5pt; /* Reducido aún más */
    line-height: 1.4; /* Más compacto */
}

.sidebar-card-item {
    margin-bottom: 8px; /* Reducido de 10px */
    padding-bottom: 8px; /* Reducido de 10px */
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.sidebar-card-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.sidebar-card-label {
    font-size: 7.5pt; /* Reducido aún más */
    opacity: 0.9;
    text-transform: uppercase;
    letter-spacing: 0.4px;
    margin-bottom: 2px; /* Reducido de 3px */
}

.sidebar-card-value {
    font-size: 9pt; /* Reducido de 10pt */
    font-weight: 600;
    opacity: 1;
}

.info-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5cm 0 0 0; /* 2 saltos de línea más (1.5cm) adicionales a las tablas */
    background: white;
    box-sizing: border-box;
    padding: 20px 28px; /* Reducido de 24px 32px */
    display: table; /* Asegurar que se comporte como tabla */
}

.info-table tr {
    background: transparent;
    border-bottom: 1px solid rgba(26, 35, 70, 0.08);
    page-break-inside: avoid;
}

.info-table tr:last-child {
    border-bottom: none;
}

.info-table td {
    padding: 5px 0; /* Reducido aún más */
    border: none;
    vertical-align: middle;
    font-size: 8.5pt; /* Reducido aún más */
    line-height: 1.3; /* Más compacto */
}

.info-table td:first-child {
    font-weight: 500;
    color: var(--movums-medium);
    width: 32%; /* Reducido de 35% */
    font-size: 8pt; /* Reducido aún más */
    text-transform: none;
    letter-spacing: 0.1px;
    background: transparent;
    padding-right: 12px; /* Reducido de 16px */
}

.info-table td:last-child {
    color: var(--movums-navy);
    font-size: 8.5pt; /* Reducido aún más */
    font-weight: 500;
    background: transparent;
}

.info-table tr:nth-child(even) {
    background: rgba(227, 242, 253, 0.3);
}

.info-table tr:nth-child(even) td:first-child {
    background: transparent;
}

/* ============================================
   SUBTÍTULOS - MODERNOS
   ============================================ */
.subtitulo-vineta {
    color: var(--movums-blue-corp);
    font-size: 14pt;
    font-weight: 700;
    margin: 20px 0 15px 0;
    display: flex;
    align-items: center;
    gap: 10px;
    letter-spacing: -0.3px;
    text-transform: uppercase;
    box-sizing: border-box;
    line-height: 1.6;
}

.subtitulo-vineta::before {
    content: "▸";
    color: var(--movums-blue-corp);
    font-size: 18pt;
    font-weight: bold;
    margin-right: 6px;
}

/* ============================================
   INFORMACIÓN INLINE - DISEÑO PULIDO
   ============================================ */
.info-inline {
    margin: 16px 0;
    display: flex;
    flex-wrap: wrap;
    gap: 24px;
    padding: 12px 0;
    box-sizing: border-box;
    width: 100%;
}

.info-item {
    display: inline-flex;
    align-items: baseline;
    gap: 10px;
    flex: 1;
    min-width: 220px;
}

.info-label {
    font-weight: 700;
    color: var(--text-secondary);
    font-size: 9pt;
    text-transform: uppercase;
    letter-spacing: 1.2px;
}

.info-value {
    color: var(--text-primary);
    font-size: 10.5pt;
    font-weight: 600;
}

.info-separator {
    color: var(--border-medium);
    margin: 0 10px;
    font-weight: 300;
}

/* ============================================
   LÍNEAS DE INFORMACIÓN
   ============================================ */
.info-line {
    margin: 14px 0;
    padding: 8px 0;
    line-height: 1.8;
    box-sizing: border-box;
    width: 100%;
}

.info-line-label {
    font-weight: 700;
    color: var(--text-secondary);
    font-size: 9pt;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-right: 12px;
}

.info-line-value {
    color: var(--text-primary);
    font-size: 10.5pt;
    font-weight: 500;
}

/* ============================================
   TOTAL DESTACADO - MUY LLAMATIVO
   ============================================ */
.total-destacado {
    margin: 0;
    padding: 8px 12px; /* Reducido aún más */
    background: var(--movums-royal);
    text-align: right;
    box-shadow: none;
    box-sizing: border-box;
    width: 100%;
    border-radius: 0 0 6px 6px; /* Reducido de 8px */
}

.total-text {
    font-size: 14pt; /* Reducido aún más */
    font-weight: 700;
    color: white;
    letter-spacing: 0.2px;
    margin: 0;
    text-shadow: none;
    display: inline-flex;
    align-items: center;
    gap: 6px; /* Reducido de 8px */
}

.total-text::before {
    content: 'Total:';
    font-size: 10pt; /* Reducido de 12pt */
    font-weight: 500;
    opacity: 0.9;
}

/* ============================================
   TABLAS DE DATOS - FORMATO TIPO TARJETA CON COLOR
   ============================================ */
.data-table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.5cm 0 0 0; /* 2 saltos de línea más (1.5cm) adicionales a las tablas */
    background: white;
    box-sizing: border-box;
    padding: 8px 12px; /* Reducido aún más para ahorrar papel */
    display: table; /* Asegurar que se comporte como tabla */
}

.data-table tr {
    background: transparent;
    border-bottom: 1px solid rgba(26, 35, 70, 0.08);
    page-break-inside: avoid;
}

.data-table tr:last-child {
    border-bottom: none;
}

.data-table th {
    background: transparent;
    color: var(--movums-navy);
    padding: 12px 0;
    text-align: left;
    font-weight: 600;
    font-size: 9pt;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    border: none;
}

.data-table td {
    padding: 5px 0; /* Reducido aún más */
    border: none;
    font-size: 8.5pt; /* Reducido de 9pt */
    vertical-align: middle;
    line-height: 1.3; /* Más compacto */
}

.data-table td:first-child {
    font-weight: 500;
    color: var(--movums-medium);
    width: 32%; /* Reducido de 35% */
    font-size: 8pt; /* Reducido aún más */
    text-transform: none;
    letter-spacing: 0.1px;
    background: transparent;
    padding-right: 12px; /* Reducido de 16px */
}

.data-table td:last-child {
    color: var(--movums-navy);
    font-size: 8.5pt; /* Reducido aún más */
    font-weight: 500;
    background: transparent;
}

/* Estilo tipo "pill" para valores monetarios cuando están en la última columna */
.data-table td:last-child strong,
.data-table td:last-child .amount-pill {
    display: inline-block;
    background: var(--movums-pale);
    color: var(--movums-navy);
    padding: 6px 16px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 10pt;
}

.data-table tr:nth-child(even) {
    background: rgba(227, 242, 253, 0.3);
}

.data-table tr:nth-child(even) td:first-child {
    background: transparent;
}

/* ============================================
   SEPARADORES Y ESPACIOS
   ============================================ */
.separator {
    height: 2px;
    background: linear-gradient(to right, transparent, var(--border-medium), transparent);
    margin: 36px 0;
}

.spacer {
    height: 28px;
}

/* ============================================
   LISTAS
   ============================================ */
.list-item {
    margin: 12px 0;
    padding-left: 28px;
    line-height: 2;
    position: relative;
}

.list-item::before {
    content: "→";
    color: var(--movums-blue-corp);
    position: absolute;
    left: 0;
    font-weight: bold;
    font-size: 14pt;
}

/* ============================================
   NOTAS Y TÉRMINOS
   ============================================ */
.notas-section {
    margin-top: 40px;
    padding: 28px;
    background: #F9FAFB;
    border-radius: 8px;
    font-size: 9.5pt;
    color: var(--text-secondary);
    border-left: 4px solid #E5E7EB;
    line-height: 1.6;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
}

.notas-section .subtitulo-vineta {
    font-size: 13pt;
    margin-bottom: 14px;
    color: var(--text-primary);
}

/* ============================================
   FOOTER - MINIMALISTA
   ============================================ */
.footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2cm;
    width: 100%;
    margin: 0;
    padding: 12px 0;
    border-top: 1px solid #E5E7EB;
    font-size: 9pt;
    color: var(--text-muted);
    text-align: center;
    line-height: 1.6;
    box-sizing: border-box;
    background: transparent; /* Transparente para ver el membrete */
    z-index: 1000;
}

.footer p {
    margin: 10px 0;
}

/* ============================================
   UTILIDADES
   ============================================ */
.text-center {
    text-align: center;
}

.text-right {
    text-align: right;
}

.text-bold {
    font-weight: 700;
}

.text-muted {
    color: var(--text-muted);
}

.mt-1 { margin-top: var(--spacing-xs); }
.mt-2 { margin-top: var(--spacing-sm); }
.mt-3 { margin-top: var(--spacing-md); }
.mt-4 { margin-top: var(--spacing-lg); }

.mb-1 { margin-bottom: var(--spacing-xs); }
.mb-2 { margin-bottom: var(--spacing-sm); }
.mb-3 { margin-bottom: var(--spacing-md); }
.mb-4 { margin-bottom: var(--spacing-lg); }

/* ============================================
   EVITAR SALTOS DE PÁGINA
   ============================================ */
.card, .info-section, .total-destacado {
    page-break-inside: avoid;
}

/* ============================================
   MEJORAS TIPOGRÁFICAS
   ============================================ */
h1, h2, h3, h4, h5, h6 {
    font-weight: 700;
    letter-spacing: -0.5px;
    line-height: 1.2;
    color: var(--text-primary);
}

p {
    margin: 14px 0;
    color: var(--text-primary);
}

/* Espaciado mejorado entre secciones */
.card + .card {
    margin-top: 36px;
}

/* Mejora visual para elementos destacados */
strong {
    font-weight: 700;
    color: var(--text-primary);
}
    </style>
</head>
<body>
    {% include "ventas/pdf/components/header.html" %}
    
    <div class="cotizacion-container">
        <!-- Spacer invisible para mantener espacio de 6 saltos de línea en todas las páginas -->
        <div class="spacer-top"></div>
        
        {% include "ventas/pdf/components/info_cliente.html" %}
        
        {% block content %}{% endblock %}
        
        {% include "ventas/pdf/components/footer.html" %}
    </div>
</body>
</html>
